apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: technitium-dns
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/auth-url: "http://skyforge-server.skyforge.svc.cluster.local:8085/api/session/traefik"
    nginx.ingress.kubernetes.io/auth-response-headers: "X-Skyforge-Username,X-Skyforge-DisplayName,X-Skyforge-Email,X-Skyforge-Groups,X-Skyforge-First-Name,X-Skyforge-Last-Name,X-Forwarded-User,X-Forwarded-Email,X-Forwarded-First-Name,X-Forwarded-Last-Name,Remote-User,Remote-User-Email,Remote-User-First-Name,Remote-User-Last-Name"
    nginx.ingress.kubernetes.io/auth-snippet: |
      proxy_set_header Cookie $http_cookie;
spec:
  ingressClassName: nginx
  tls:
    - hosts:
        - __SKYFORGE_HOSTNAME__
      secretName: proxy-tls
  rules:
    - host: __SKYFORGE_HOSTNAME__
      http:
        paths:
          - path: /dns
            pathType: Prefix
            backend:
              service:
                name: technitium-dns
                port:
                  number: 5380
